#+TITLE: My configuration of Emacs
#+STARTUP: showeverything
#+STARTUP: inlineimages
#+AUTHOR: Prutserdt

#+CAPTION: Doom Emacs
#+ATTR_HTML: :alt Doom Emacs :title Doom Emacs :align left
[[https://github.com/Prutserdt/dotfiles/raw/master/.doom.d/doom-emacs.png]]

* Table Of Contents :toc:
- [[#about-this-config][About this config]]
- [[#initel][init.el]]
- [[#packagesel][packages.el]]
- [[#configel][config.el]]
- [[#some-tinkering][Some tinkering]]
- [[#todos][TODOs]]
  - [[#create-custom-welcome-screen-splash-screen][Create custom welcome screen (splash screen)]]
  - [[#mu4e][MU4e]]
- [[#credits][Credits]]

* About this config
This is my personal [[https://github.com/hlissner/doom-emacs][Doom Emacs]] config. Nothing much to see here. Just started this journey and learning [[https://www.gnu.org/software/emacs/][Emacs]] and [[https://en.wikipedia.org/wiki/Literate_programming][literate programming]] along the way. The Emacs Lisp files [[https://github.com/Prutserdt/dotfiles/blob/master/.doom.d/init.el][init.el]], [[https://github.com/Prutserdt/dotfiles/blob/master/.doom.d/packages.el][packages.el]] and [[https://github.com/Prutserdt/dotfiles/blob/master/.doom.d/config.el][config.el]] are generated from [[https://github.com/Prutserdt/dotfiles/blob/master/.doom.d/README.org][this README.org file]] by tangling in Emacs ='M-x' 'org-babel-tangle' RET=. Remember to run =~/.emacs.d/bin/doom sync= in the terminal after modifications!

* init.el
This file controls what Doom modules are enabled and what order they load in. Remember to tangle this README.org file and running =~/.emacs.d/bin/doom sync= after modifying it!

#+begin_src emacs-lisp :tangle init.el
;;; init.el -*- lexical-binding: t; -*-

;; NOTE This file is generated from the README.org file. Do not alter
;; init.el directly and only modify the README.org file in emacs by
;; 'M-x' 'org-babel-tangle' RET and run $ '~/.emacs.d/bin/doom sync'

(doom! :completion
       company           ; the ultimate code completion backend
       vertico           ; the search engine of the future

       :ui
       doom              ; what makes DOOM look the way it does
       doom-dashboard    ; a nifty splash screen for Emacs
       (emoji +unicode)  ; รฐ
       hl-todo           ; highlight TODO/FIXME/NOTE/DEPRECATED/HACK/REVIEW
       modeline          ; snazzy, Atom-inspired modeline, plus API
       ophints           ; highlight the region an operation acts on
       (popup +defaults) ; tame sudden yet inevitable temporary windows
       vc-gutter         ; vcs diff in the fringe
       vi-tilde-fringe   ; fringe tildes to mark beyond EOB
       workspaces        ; tab emulation, persistence & separate workspaces

       :editor
       (evil +everywhere); come to the dark side, we have cookies
       file-templates    ; auto-snippets for empty files
       fold              ; (nigh) universal code folding
       snippets          ; my elves. They type so I don't have to

       :emacs
       (dired +icons)    ; making dired pretty [functional]
       electric          ; smarter, keyword-based electric-indent
       undo              ; persistent, smarter undo for your inevitable mistakes
       vc                ; version-control and :Emacs, sitting in a tree

       :term
       vterm             ; the best terminal emulation in Emacs

       :checkers
       syntax            ; tasing you for every semicolon you forget

       :tools
       (eval +overlay)   ; run code, run (also, repls)
       lookup            ; navigate your code and its documentation
       lsp               ; M-x vscode
       magit             ; a git porcelain for Emacs

       :lang
       emacs-lisp        ; drown in parentheses
       markdown          ; writing docs for people to ignore
       (org +pretty)     ; organize your plain life in plain text
       (python +lsp
        +pyright)        ; beautiful is better than ugly
       sh                ; she sells {ba,z,fi}sh shells on the C xor

       :app

       :config
       (default +bindings +smartparens)
       )
#+end_src


The folowing options could be added to the init.el part that is listed above. Just copy/paste the section and uncomment it. Tip: the list of modules can be checked in emacs by 'C-h' d m

#+begin_src emacs-lisp
       ;; :completion
       ;;helm              ; the *other* search engine for love and life
       ;;ido               ; the other *other* search engine...
       ;;ivy               ; a search engine for love and life

       ;; :UI
       ;;doom-quit         ; DOOM quit-message prompts when you quit Emacs

       ;; :lang
       ;;julia             ; a better, faster MATLAB
       ;;kotlin            ; a better, slicker Java(Script)
       ;;latex             ; writing papers in Emacs has never been so fun
       ;;lean              ; for folks with too much to prove
       ;;ledger            ; be audit you can be
       ;;lua               ; one-based indices? one-based indices
       ;;erlang            ; an elegant language for a more civilized age
       ;;ess               ; emacs speaks statistics
       ;;factor
       ;;faust             ; dsp, but you get to keep your soul
       ;;fortran           ; in FORTRAN, GOD is REAL (unless declared INTEGER)
       ;;fsharp            ; ML stands for Microsoft's Language
       ;;fstar             ; (dependent) types and (monadic) effects and Z3
       ;;gdscript          ; the language you waited for
       ;;(go +lsp)         ; the hipster dialect
       ;;(haskell +lsp)    ; a language that's lazier than I am
       ;;hy                ; readability of scheme w/ speed of python
       ;;idris             ; a language you can depend on
       ;;json              ; At least it ain't XML
       ;;(java +lsp)       ; the poster child for carpal tunnel syndrome
       ;;javascript        ; all(hope(abandon(ye(who(enter(here))))))
       ;;nim               ; python + lisp at the speed of c
       ;;nix               ; I hereby declare "nix geht mehr!"
       ;;ocaml             ; an objective camel
       ;;php               ; perl's insecure younger brother
       ;;plantuml          ; diagrams for confusing people more
       ;;purescript        ; javascript, but functional
       ;;qt                ; the 'cutest' gui framework ever
       ;;racket            ; a DSL for DSLs
       ;;raku              ; the artist formerly known as perl6
       ;;rest              ; Emacs as a REST client
       ;;rst               ; ReST in peace
       ;;(ruby +rails)     ; 1.step {|i| p "Ruby is #{i.even? ? 'love' : 'life'}"}
       ;;rust              ; Fe2O3.unwrap().unwrap().unwrap().unwrap()
       ;;scala             ; java, but good
       ;;(scheme +guile)   ; a fully conniving family of lisps
       ;;sml
       ;;solidity          ; do you need a blockchain? No.
       ;;swift             ; who asked for emoji variables?
       ;;terra             ; Earth and Moon in alignment for performance.
       ;;web               ; the tubes
       ;;yaml              ; JSON, but readable
       ;;zig               ; C, but simpler

       ;; :term
       ;;term              ; terminals in emacs

       ;; :email
       ;;(mu4e +org +gmail)
       ;;notmuch
       ;;(wanderlust +gmail)

       ;; :app
       ;;calendar
       ;;emms
       ;;everywhere        ; *leave* Emacs!? You must be joking
       ;;irc               ; how neckbeards socialize
       ;;(rss +org)        ; emacs as an RSS reader
       ;;twitter           ; twitter client https://twitter.com/vnought

       ;; :os
       ;;(:if IS-MAC macos)  ; improve compatibility with macOS
       ;; :config
       ;;literate
#+end_src

* packages.el
Here the packages are defined which should be installed. This is an addition to the already installed and loaded modules of init.el.

#+begin_src emacs-lisp :tangle packages.el

;; -*- no-byte-compile: t; -*-

;; NOTE This file is generated from the README.org file. Do not alter
;; packages.el directly and only modify the README.org file in emacs by
;; 'M-x' 'org-babel-tangle' RET and run $ '~/.emacs.d/bin/doom sync'

(require 'package)
(add-to-list 'package-archives
             '("melpa" . "https://melpa.org/packages/"))
(package-refresh-contents)
(package-initialize)

;; Disable the nose package. Not maintained and leading to :lang python error
(package! nose :disable t)

;; Help finding the cursor
(package! beacon)

;; Wrapping lines at fill-column and centering text
(package! visual-fill-column)

#+end_src

* config.el
The custom configurations are set here. For instance theme settings, image to the doom splash screen, transparency, relative numbering and email settings.

#+begin_src emacs-lisp :tangle config.el

;; NOTE This file is generated from the README.org file. Do not alter
;; config.el directly and only modify the README.org file in emacs by
;; 'M-x' 'org-babel-tangle' RET and reload by 'M-x' 'doom/reload' RET

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                  Revert Doom Emacs opinionated stuff              ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


;; Hide the toolbar
(tool-bar-mode -1)

;; Restoring to behavior of VIM (Y:yank the whole line, independent on position)
(setq! evil-want-Y-yank-to-eol nil)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                           Visual stuff                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; Add this image to my splash screen
(setq fancy-splash-image "~/.doom.d/doom-emacs.png")

;; Set the font
(set-frame-font "Hack 12" t t)
(setq default-frame-alist '((font . "Hack 13")))

;; Help to find the cursor by beacon blink
(beacon-mode 1)
(setq beacon-blink-duration 3)

;; Make the normal/insert/visual states more apparent by changing cursor:
(setq evil-normal-state-cursor '(box "tomato")
      evil-insert-state-cursor '(bar "white")
      evil-visual-state-cursor '(hollow "orange"))

;; Nice bullets instead of boring *. Requires (org +pretty)
(setq org-superstar-headline-bullets-list '("โ" "โ" "โฟ" "โธ" "โ" ))

;; Set flashing of yanked text to a longer interval, default is 0.2
(setq evil-goggles-duration 1.0)

;; Rainbow delimiters, help to find the matching parenthesis
(use-package rainbow-delimiters
  :hook (prog-mode . rainbow-delimiters-mode)
  :hook (org-mode . rainbow-delimiters-mode)
  )

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                       Custom keybindings                          :
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(global-set-key "\C-h" 'recentf-open-more-files)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                               Other                               :
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; Set relative numbering. 'SPC' 't'  'l'
(global-display-line-numbers-mode)
(setq display-line-numbers-type 'relative)

;; Visual fill column, to break the lines that otherwise will keep on going
;; Related: visual-fill-column-mode, global-visual-line =set-fill-column 80=
;;(setq-default Fill-column 110)
;;(setq set-fill-column 110)
;;(setq set-fill-column 110)
;;(setq fill-column 110)
;;(auto-fill-mode 1)
;;(setq fill-column 110)
;;(setq-default display-fill-column-indicator-column 100)
;;(setq-default fill-column 110)
;; FIXME: the 110 column width is not set...? Weird,
;;        the other tries, pasted above, also did not work...
(setq-default visual-fill-column-width 110)
(add-hook 'visual-line-mode-hook 'visual-fill-column-mode)
;; Center to the middle of the screen
(setq-default visual-fill-column-center-text t)

;; Transparency
(set-frame-parameter (selected-frame) 'alpha '(95 90))
(add-to-list 'default-frame-alist '(alpha 95 90))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;                              Old stuff                            ;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; The lines below are removed and are kept here for a while and can be deleted later.

;; Show the 80 column (Fill Column Indicator)
;; NOTE: does not work in combination with visual-fill-column-mode
;;       and can be removed...
(global-display-fill-column-indicator-mode)

;; Highlight the matching parenthesis pair
;; Removed, since smartparens is already in init.el and the next line is not needed.
;; Remove this line later when it is tested and proven to be not needed.
;;(setq show-paren-mode 1)

;; There are error in the bootscreen after the first loading: no splashscreen
;; and no icons. This can be corrected by running doom/reload, this is not
;; recommended and gives a void-variable doom/reload error but it seems to work for now...
;;(doom/reload)

;; Quit immediately, without a confirmation
;;(setq confirm-kill-emacs nil)

#+end_src


* Some tinkering

Not all tinkering should be part of the three configuration files that are described above.

Choose a theme by 'M-x' RET 'load-theme' and choose for instance: doom-darktooth, doom-moonlight, doom-vibrant, doom-tokyo-night, doom-dracula, doom-material-dark, doom-xcode or doom-zenburn,

Highlight the current selected line: 'M-x' RET 'hl-line-mode' RET


* TODOs
Here is a list of things I want to add/improve in my Doom Emacs configuration.

** Create custom welcome screen (splash screen)
Would be nice to change it, modifying the default requires too much effort. Just create a simple page with an image and a few options shoudl be relatively simple....

** MU4e
Needs to be configured properly...

mu4e should be uncommented in init.el and the mu4e package should be added to package.el:
#+begin_src emacs-lisp

;; The email package MU for emacs
(package! mu4e)

#+end_src

The following code block should be part of config.el:
#+begin_src emacs-lisp

(setq mail-user-agent 'mu4e-user-agent)
(set-email-account!
 "transip"
 '((mu4e-sent-folder       . "/transip/Sent Mail")
   (mu4e-trash-folder      . "/transip/Bin")
   (smtpmail-smtp-user     . "email@adress.com"))
 t)
(setq mu4e-get-mail-command "mbsync transip "
    ;; get emails and index every 5 minutes
      mu4e-update-interval 300
      ;; send emails with format=flowed
      mu4e-compose-format-flowed t
      ;; no need to run cleanup after indexing for gmail
      mu4e-index-cleanup nil
      mu4e-index-lazy-check t
      ;; more sensible date format
      mu4e-headers-date-format "%d.%m.%y")
;; tell message-mode how to send mail
(setq message-send-mail-function 'smtpmail-send-it)
;; if our mail server lives at smtp.example.org; if you have a local
;; mail-server, simply use 'localhost' here.
(setq smtpmail-smtp-server "smtp.transip.email")

#+end_src

* Credits
My configuration of Doom Emacs is partially based on these ones.
- :book: https://gitlab.com/zzamboni/dot-doom
- :book: https://gitlab.com/dwt1/dotfiles/-/tree/master/.emacs.d.gnu
